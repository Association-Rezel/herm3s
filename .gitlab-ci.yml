stages:
  - triggers

main:
  stage: triggers
  variables:
    SKIP_UNIT_TESTS: "true"
  trigger:
    include: gitlab-ci/main.yml
    strategy: depend
    forward:
      pipeline_variables: true

publish-to-github:
  stage: triggers
  trigger:
    include: gitlab-ci/publish-to-github.yml
    strategy: depend
    forward:
      pipeline_variables: true
  rules:
    - if: $CI_COMMIT_BRANCH != $CI_DEFAULT_BRANCH && $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - when: always